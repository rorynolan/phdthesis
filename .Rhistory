tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
str_c("$", ., "$")
)
c(1, expression(2))
factor(1, 2, levels = c(1, expression(2)))
factor(c(1, 2), levels = c(1, expression(2)))
levels(.Last.value)
factor(c(1, 2), levels = c(1, expression(2*a)))
levels(.Last.value)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau="))
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=")) %>%
mutate(line = as_factor(line))
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=")) %>%
mutate(line = as_factor(line))
str(.Last.value$line)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=")) %>%
mutate(line = as_factor(line))
levels(.Last.value$line)
?plotmath
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
str_replace_all(" ", "~~")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
str_replace_all(" ", "~")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
str_replace_all(" ", "~")) %>%
pull(line)
TeX("$\\tau = 1")
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau==") %>%
str_replace_all(" ", "~")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
TeX("$x_1$")
TeX("$x_1$", "text")
TeX("$x_1$", "text") %>% toString()
all.equal(TeX("$x_1$", "text"), TeX("$x_1$"))
all.equal(TeX("$x_1$", "t"), TeX("$x_1$"))
all.equal(TeX("$x_1$", "c"), TeX("$x_1$"))
TeX("$x_1$", "c")
devtools::install_github('stefano-meschiari/latex2exp')
pkgs <- c("tidyverse", "patchwork", "forcats", "magrittr", "ijtiff",
"detrendr", "nandb", "filesstrings", "knitr", "latex2exp",
"janitor", "RcppRoll", "abind", "brownded", "here")
lapply(pkgs, library, character.only = TRUE)
?TeX
TeX("$x_1")
TeX("$x_1", "c")
TeX("this and that")
TeX("this and that", "c")
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
TeX("char")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
# Chunk 1: bleaching-sim
img1 <- read_tif(here("img", "sim1.tif"), msg = FALSE)
img1_bleached <- read_tif(here("img", "sim1_bleached.tif"), msg = FALSE)
img2 <- read_tif(here("img", "sim2.tif"), msg = FALSE)
img2_bleached <- read_tif(here("img", "sim2_bleached.tif"), msg = FALSE)
mx <- max(c(img1, img2, img1_bleached, img2_bleached))
sidebyside3space <- function(arr3d, mx) {
lst <- map(seq_len(dim(arr3d)[3]), ~ arr3d[, , .])
reduce(lst, ~ cbind(.x, mx, mx, mx, .y))
}
frames <- c(1, 100, 200, 300, 400, 500)
to_display <- rbind(sidebyside3space(img1_bleached[, , 1, frames], mx),
mx, mx, mx, mx, mx,
sidebyside3space(img2_bleached[, , 1, frames], mx))
ijtiff::display(to_display)
# Chunk 2: bleaching-sim-mean-intensity
df_bleach_sim <- tibble(simulation = c("img1", "img1_bleached",
"img2", "img2_bleached"),
img = list(img1, img1_bleached, img2, img2_bleached),
frame = map(img, ~ seq_len(dim(.)[4])),
mean_intensity = map(img, apply, 4, mean)) %>%
select(-img) %>%
unnest()
ggplot(df_bleach_sim, aes(x = frame, y = mean_intensity, colour = simulation)) +
geom_line() + ylab("mean intensity") +
ylim(50, max(df_bleach_sim$mean_intensity))
# Chunk 3
The _median mean pixel intensity_ of an image series is found by taking the mean intensity of each pixel in the image series and then taking the median of those means. It can be thought of as a summary statistic for the pixel intensity of the image series.
# Chunk 4
The _median pixel intensity variance_ of an image series is found by taking the variance in the intensity of each pixel in the image series and then taking the median of those variances. It can be thought of as a summary statistic for the variance in the pixel intensity of the image series.
# Chunk 5: visualize-variance-decrease
df_var_dec_vis <- tibble(rate = seq(100, 0, length.out = 300),
value = detrendr:::myrpois(rate))
ggplot(df_var_dec_vis, aes(rate, value)) + scale_x_reverse() +
geom_segment(x = -100, y = 100, xend = 0, yend = 0,
colour = "blue") +
geom_line(colour = "black")
# Chunk 6: exp-fit-bleach
set.seed(1)
means <- 100
bleach_rate <- bleach_fraction_to_rate(0.2, 500)
for (i in 1:499) means %<>% c((1 - bleach_rate) * last(.))
devs <- detrendr:::myrpois(means * (1 - 0.9))
df_exp_fit_bleach <- tibble(
intensity_value = means * 0.9 + devs,
time = seq_along(intensity_value),
exponential = means) %>%
gather(line, intensity_value, c(intensity_value, exponential)) %>%
mutate(line = if_else(line == "exponential", "exponential fit",
"intensity over time"))
ggplot(df_exp_fit_bleach, aes(time, intensity_value, colour = line)) +
geom_line() + ylab("intensity value")
# Chunk 7: exp-fit-corr
df_exp_fit_corr <- df_exp_fit_bleach %>%
mutate(mean = round(mean(means)),
intensity_value = mean + intensity_value - means) %>%
select(time, intensity_value, mean) %>%
gather(line, intensity_value, c(intensity_value, mean)) %>%
mutate(line = if_else(line == "mean", "mean intensity",
"intensity over time"))
ggplot(df_exp_fit_corr, aes(time, intensity_value, colour = line)) +
geom_line() + ylab("intensity value") +
scale_color_manual(values = rev(gg_color_hue(2)))
# Chunk 8: exp-decay-with-sin
sin_means <- means %>% {. + 5 * sin(seq_along(.) / 50)}
df_exp_fit_bleach_sin <- tibble(
intensity_value = sin_means * 0.9 + devs,
time = seq_along(intensity_value),
exponential = means) %>%
gather(line, intensity_value, c(intensity_value, exponential)) %>%
mutate(line = if_else(line == "exponential", "exponential fit",
"intensity over time") %>%
factor(levels = c("exponential fit", "intensity over time")))
ggplot(df_exp_fit_bleach_sin, aes(time, intensity_value, colour = line)) +
geom_line() + ylab("intensity value")
# Chunk 9: exp-fit-decay-with-sin-corr
df_exp_fit_bleach_sin_corr <- df_exp_fit_bleach_sin %>%
mutate(mean = round(mean(sin_means)),
intensity_value = mean + intensity_value - means) %>%
select(time, intensity_value, mean) %>%
gather(line, intensity_value, c(intensity_value, mean)) %>%
mutate(line = if_else(line == "mean", "mean intensity",
"intensity over time"))
ggplot(df_exp_fit_bleach_sin_corr, aes(time, intensity_value, colour = line)) +
geom_line() + ylab("intensity value") +
scale_color_manual(values = rev(gg_color_hue(2)))
# Chunk 10: boxcar-explanation
set.seed(9)
boxcar_explain_df <- tibble(y = seq(0, 2, length.out = 9) + runif(9),
t = seq_along(y))
boxcar_means_df <- tibble(t = roll_mean_n_by_nofill(boxcar_explain_df$t, 3),
y = roll_mean_n_by_nofill(boxcar_explain_df$y, 3))
ggplot(boxcar_explain_df, aes(t, y)) +
geom_point(colour = gg_color_hue(2)[1], size = 2) +
geom_point(data = boxcar_means_df, aes(t, y),
colour = gg_color_hue(2)[2], size = 3) +
geom_rect(xmin = 1 - 0.2, xmax = 3 + 0.2,
ymin = boxcar_means_df$y[1] - 0.5,
ymax = boxcar_means_df$y[1] + 0.5,
colour = gg_color_hue(2)[2], alpha = 0) +
geom_rect(xmin = 4 - 0.2, xmax = 6 + 0.2,
ymin = boxcar_means_df$y[2] - 0.5,
ymax = boxcar_means_df$y[2] + 0.5,
colour = gg_color_hue(2)[2], alpha = 0) +
geom_rect(xmin = 7 - 0.2, xmax = 9 + 0.2,
ymin = boxcar_means_df$y[3] - 0.5,
ymax = boxcar_means_df$y[3] + 0.5,
colour = gg_color_hue(2)[2], alpha = 0) +
ylim(-0.3, 3) + xlab("time")
# Chunk 11: boxcar-sizes
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(boxcar1 = detrendr:::boxcar_smooth(intensity_over_time, 1),
boxcar3 = detrendr:::boxcar_smooth(intensity_over_time, 3),
boxcar75 = detrendr:::boxcar_smooth(intensity_over_time, 75),
boxcar300 = detrendr:::boxcar_smooth(intensity_over_time, 300),
boxcar1000 = detrendr:::boxcar_smooth(intensity_over_time, 1000)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("boxcar", "boxcar l=")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2)
# Chunk 12
The _mean intensity profile_ of one channel of an image series is obtained by calculating the mean intensity of each frame in that image series.
# Chunk 13: exp-smooth-func
exp_smooth_func <- function(t, tau) exp(-abs(t / tau))
ggplot(tibble(x = 0, y = x)) + aes(x) +
stat_function(fun = exp_smooth_func, args = list(tau = 2),
aes(colour = "red")) +
stat_function(fun = exp_smooth_func, args = list(tau = 9),
aes(colour = "blue")) +
xlim(-30, 30) +
ylab(TeX("$\\exp\\left(-\\frac{|t|}{\\tau}\\right)$")) + xlab(TeX("$t$")) +
scale_colour_manual("", values = c(red = "red", blue = "blue"),
labels = unname(TeX(c("$\\tau = 3$", "$\\tau = 9$"))))
# Chunk 14: tau-values
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
TeX("char")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
TeX("char")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
if_else(str_detect(., "="), str_c("$", ., "$"), .) %>%
TeX("char")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
if_else(str_detect(., "="), str_c("$\\", ., "$"), .) %>%
TeX("char")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
if_else(str_detect(., "="), str_c("$\\", ., "$"), .) %>%
TeX("char"))
.Last.value %>% pull(line) %>% unique()
TeX("$\\tau=3$")
TeX("$\\tau=3$", "c")
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
if_else(str_detect(., "="), str_c("$\\", ., "$"), .) %>%
TeX("char") %>%
unname()) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
if_else(str_detect(., "="), str_c("$\\", ., "$"), .) %>%
TeX("char") %>%
unname()) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed) + ylab(TeX("$\\tau=3$"))
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau=") %>%
if_else(str_detect(., "="), str_c("$\\", ., "$"), .) %>%
TeX("char") %>%
unname()) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed) + ylab(TeX("$\\tau = 3$"))
df_exp_fit_bleach %>%
spread(line, intensity_value) %>%
clean_names() %>%
select(-exponential_fit) %>%
mutate(tau1 = detrendr:::exp_smooth(intensity_over_time, 1, 999),
tau3 = detrendr:::exp_smooth(intensity_over_time, 3, 999),
tau75 = detrendr:::exp_smooth(intensity_over_time, 75, 999),
tau300 = detrendr:::exp_smooth(intensity_over_time, 300, 999),
tau1000 = detrendr:::exp_smooth(intensity_over_time, 1000, 999)) %>%
gather(line, intensity, -time) %>%
arrange(first_number(line) %T>% {.[is.na(.)] <- min(., na.rm = TRUE) - 1}) %>%
mutate(line = str_replace_all(line, "_", " ") %>%
str_replace("tau", "tau = ") %>%
if_else(str_detect(., "="), str_c("$\\", ., "$"), .) %>%
TeX("char")) %>%
mutate(line = as_factor(line)) %>%
ggplot() + aes(time, intensity) + geom_line() +
facet_wrap(~ line, nrow = 2, labeller = label_parsed)
bookdown:::serve_book()
bookdown::render_book("index.Rmd", bookdown::pdf_book())
